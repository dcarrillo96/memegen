<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Composite Video Overlay App</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js" crossorigin></script>
  <style>
    body { font-family: Arial, sans-serif; background: #f5f5f5; margin: 0; padding: 20px; }
    .app-container { max-width: 800px; margin: 0 auto; padding: 20px; background: #fff; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    .video-frame { position: relative; width: 100%; height: 480px; background: #000; }
    .video-frame video { width: 100%; height: 100%; object-fit: contain; }
    .overlay-text { position: absolute; top: 10px; left: 50%; transform: translateX(-50%); color: #fff; font-size: 24px; font-weight: bold; }
    .overlay-logo { position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); width: 120px; }
    .controls { display: flex; flex-direction: column; gap: 12px; }
  </style>
</head>
<body>
  <div id="video-overlay-app"></div>

  <script type="text/babel">
    const VideoOverlayApp = () => {
      const [videoFile, setVideoFile] = React.useState(null);
      const [text, setText] = React.useState('Your Overlay Text');
      const videoRef = React.useRef(null);

      const handleVideoUpload = (e) => {
        const file = e.target.files[0];
        if (file) setVideoFile(URL.createObjectURL(file));
      };

      const downloadCompositeVideo = () => {
        const canvas = document.createElement('canvas');
        canvas.width = 1920;
        canvas.height = 1080;
        const ctx = canvas.getContext('2d');
        const stream = canvas.captureStream(30);
        const recorder = new MediaRecorder(stream, { mimeType: 'video/webm; codecs=vp9' });
        const chunks = [];

        recorder.ondataavailable = (e) => chunks.push(e.data);
        recorder.onstop = () => {
          const blob = new Blob(chunks, { type: 'video/mp4' });
          const url = URL.createObjectURL(blob);
          const link = document.createElement('a');
          link.href = url;
          link.download = 'composite-video.mp4';
          link.click();
        };

        const drawFrame = () => {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          ctx.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);
          ctx.fillStyle = '#FFFFFF';
          ctx.font = '48px Arial';
          ctx.textAlign = 'center';
          ctx.fillText(text, canvas.width / 2, 80);
          const logo = new Image();
          logo.src = './your-logo.png';
          logo.onload = () => ctx.drawImage(logo, (canvas.width - 150) / 2, canvas.height - 150, 150, 150);

          if (recorder.state === 'recording') requestAnimationFrame(drawFrame);
        };

        videoRef.current.play();
        recorder.start();
        drawFrame();

        setTimeout(() => recorder.stop(), videoRef.current.duration * 1000);
      };

      return (
        <div className="app-container">
          <div className="controls">
            <input type="file" accept="video/*" onChange={handleVideoUpload} />
            <input type="text" placeholder="Enter Overlay Text" value={text} onChange={(e) => setText(e.target.value)} />
            <button onClick={downloadCompositeVideo} disabled={!videoFile}>Download Composite Video (MP4)</button>
          </div>

          <div className="video-frame">
            {videoFile && <video ref={videoRef} src={videoFile} controls muted loop />}
            <div className="overlay-text">{text}</div>
            <img src="./your-logo.png" alt="Logo" className="overlay-logo" />
          </div>
        </div>
      );
    };

    ReactDOM.render(<VideoOverlayApp />, document.getElementById('video-overlay-app'));
  </script>
</body>
</html>
